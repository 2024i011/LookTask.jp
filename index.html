<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>パーソナルダッシュボード</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#111827">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="mb-8 relative">
            <div class="flex justify-between items-start">
                <div>
                    <div id="dynamic-greeting" class="text-2xl md:text-3xl font-bold mb-2"></div>
                    <p id="current-date" class="text-lg"></p>
                </div>
                <div class="text-right">
                    <div id="clock" class="text-3xl md:text-5xl font-semibold"></div>
                    <div class="flex items-center justify-end space-x-4 mt-2 text-2xl">
                        <button id="theme-toggle-btn" class="hover:opacity-80 transition-opacity"></button>
                        <button id="settings-btn" class="hover:opacity-80 transition-opacity"><i class="fas fa-cog"></i></button>
                    </div>
                </div>
            </div>
        </header>

        <main id="dashboard-grid" class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div id="weather-widget" class="card md:col-span-1 widget-card">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-cloud-sun mr-3"></i>天気</h2>
                <div id="weather-info" class="text-center flex-grow flex flex-col justify-center"></div>
            </div>
            <div id="news-widget" class="card md:col-span-3 widget-card">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-newspaper mr-3"></i>ニュース</h2>
                <div id="news-content" class="flex-grow overflow-y-auto max-h-72"></div>
            </div>
            <div id="traffic-widget" class="card md:col-span-4 widget-card hidden">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-train-subway mr-3"></i>JR東日本 運行情報 (東北エリア)</h2>
                <div id="traffic-info" class="space-y-3 overflow-y-auto max-h-48"></div>
            </div>
            <div id="calendar-widget" class="card md:col-span-2 widget-card hidden">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-calendar-alt mr-3"></i>カレンダー</h2>
                <div id="calendar-content" class="flex-grow overflow-y-auto max-h-72"></div>
                <div id="local-event-adder" class="hidden mt-4">
                    <div class="flex"><input type="text" id="event-input" class="w-full bg-input-bg border border-border-color rounded-l-md px-4 py-2" placeholder="今日の予定を追加..."><button id="add-event-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r-md">追加</button></div>
                </div>
            </div>
            <div id="notification-widget" class="card md:col-span-2 widget-card hidden">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-bell mr-3"></i>通知</h2>
                <div class="flex justify-start space-x-2 mb-4 border-b border-border-color pb-3"><button class="notification-tab" data-tab="line"><i class="fab fa-line mr-2"></i>LINE</button><button class="notification-tab" data-tab="discord"><i class="fab fa-discord mr-2"></i>Discord</button><button class="notification-tab active" data-tab="gmail"><i class="fas fa-envelope mr-2"></i>Gmail</button></div>
                <div class="flex-grow overflow-y-auto max-h-60"><div id="line-content" class="notification-content space-y-3"></div><div id="discord-content" class="notification-content space-y-3"></div><div id="gmail-content" class="notification-content active space-y-3"></div></div>
            </div>
            <div id="reminder-widget" class="card md:col-span-2 widget-card hidden">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-list-check mr-3"></i>リマインダー</h2>
                <div class="flex mb-4"><input type="text" id="task-input" class="w-full bg-input-bg border border-border-color rounded-l-md px-4 py-2" placeholder="新しいタスクを入力..."><button id="add-task-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r-md">追加</button></div>
                <div id="task-list" class="max-h-60 overflow-y-auto"></div>
            </div>
            <div id="music-widget" class="card md:col-span-2 widget-card hidden">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fab fa-spotify mr-3"></i>音楽</h2>
                <div id="spotify-player" class="flex-grow"><iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M" width="100%" height="100%" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe></div>
            </div>
            <div id="photo-widget" class="card md:col-span-2 widget-card hidden">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-image mr-3"></i>フォトフレーム</h2>
                <div id="photo-content" class="flex-grow flex items-center justify-center bg-input-bg rounded-md min-h-[200px]"><label class="cursor-pointer p-4 text-center"><i class="fas fa-plus-circle text-2xl mb-2"></i><br>写真を選択<input type="file" id="photo-input" class="hidden" accept="image/*"></label></div>
            </div>
            <div id="media-widget" class="card md:col-span-2 widget-card hidden">
                <h2 class="text-xl font-semibold mb-4 flex items-center"><i class="fas fa-play-circle mr-3"></i>メディアプレイヤー</h2>
                <div id="media-content" class="flex-grow flex flex-col items-center justify-center min-h-[200px]"><div id="media-player-container"></div><label class="cursor-pointer mt-4 p-2 bg-item-bg rounded-md"><i class="fas fa-folder-open mr-2"></i>ファイルを選択<input type="file" id="media-input" class="hidden" accept="video/*,audio/*"></label></div>
            </div>
        </main>
    </div>

    <div id="settings-modal" class="modal-overlay"> ... </div>
    <button id="add-tab-btn" class="fixed bottom-6 right-6 bg-blue-600 text-white w-14 h-14 rounded-full flex items-center justify-center text-2xl shadow-lg hover:bg-blue-700 transition-colors"><i class="fas fa-plus"></i></button>
    <div id="tab-settings-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-6">ウィジェットの表示設定</h2>
            <div id="widget-toggle-list" class="grid grid-cols-2 gap-4"></div>
            <div class="mt-8 flex justify-end"><button id="close-tab-settings-btn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-md">閉じる</button></div>
        </div>
    </div>
    
    <script src="script.js" defer></script>
    <script>if ('serviceWorker' in navigator) { window.addEventListener('load', () => navigator.serviceWorker.register('/sw.js')); }</script>
</body>
</html>